define("classroom-controller",[],function(){function e(e,s,t){function r(){s.setHeaderActive(!0),e.init(),o(),i()}function o(){e.getClassroomBasicDetails(t.projectId).then(function(e){c.classroomBasicDetails=e},function(e){c.errors.classroomPermissionFetch=e})}function i(){c.events.reloadClassroomBasicDetails=a,c.events.renewEnrollment=n,c.events.gotoEvaluationHistory=l}function a(){c.errors.classroomPermissionFetch=null,o()}function n(){e.renewEnrollment(c.classroomBasicDetails)}function l(){e.gotoEvaluationHistory()}var c=this;c.classroomBasicDetails={},c.messages=e.messages,c.paths=e.paths,c.request=e.request,c.subscriptionDetails=e.subscriptionDetails,c.ajaxLoaderClassroomBase={msg:c.messages.getMessage("settingUpClassroom"),loaderImg:c.paths.ajaxLoaderImg},c.errors={classroomPermissionFetch:null},c.events={},r()}return e.$inject=["classroomService","headerService","$stateParams"],e}),define("classroom-service",[],function(){function e(e,s,t,r,o,i,a,n,l,c,u,d,p,m,v){function g(){P(),h()}function f(s){function i(){return w.hasOwnProperty(s)?w[s].promise:a()}function a(){function i(){var e;return e={error:!0,msg:o.getComponentMessages("classroomMessages").getMessage("classroomDetailsFetchFail")}}function a(e){var s={};return e.hasOwnProperty("enrollment_expired")?(s.isEnrollmentExpired=1===parseInt(e.enrollment_expired),s.expiredOn=l.getLocalMediumDateTimeByTimestamp(null,e.enrollment_expired_on),s.extensionDays=e.extension_days,s.renewFees=e.renew_fees):(s.error=1===parseInt(e.error),s.isEvaluationHistoryExists=1===parseInt(e.isEvaluationHistoryExists),s.isInstructor=1===parseInt(e.isInstructor),s.isMentor=1===parseInt(e.isMentor),s.isPaidUser=1===parseInt(e.isPaidUser),s.isProjectVerifiable=1===parseInt(e.isProjectVerifiable),s.isStudent=1===parseInt(e.isStudent),s.projectName=e.projectName,s.projectId=e.projectId,s.isEnrollmentExpired=!1,s.enrollmentExpiringOn=e.enrollment_expires_on?l.getLocalMediumDateByTimestamp(null,e.enrollment_expires_on):null),s}return w[s]=e.defer(),b.request.isPermissionChecksAvailable=!1,b.request.fetchingClassroomBasicDetails=!0,t.getClassroomBasicDetails({projectId:s}).$promise.then(function(e){return e=r.processData(e),b.request.fetchingClassroomBasicDetails=!1,1===parseInt(e[0].error)||0===parseInt(e[0].isInstructor)&&3!==parseInt(e[0].projectStatus)?(delete w[s],v.redirectOnPermissionDenied()):(b.request.isPermissionChecksAvailable=!0,void w[s].resolve(a(e[0])))},function(e){b.request.fetchingClassroomBasicDetails=!1,e=r.processError(e),w[s]&&(w[s].reject(i()),delete w[s])}),w[s].promise}return i()}function y(e){if(!e.isPaidUser){b.request.displayBalanceDeduct=!0;var s=d.convertAmount(e.renewFees);p.balancePopup({amount:e.renewFees,balanceDeductMessage:b.messages.deductBalance(s.formattedCurrency),insufficientFundsMessage:function(s){var t=parseInt(e.renewFees)-s.balance;return t=d.convertAmount(t),o.getComponentMessages("classroomMessages").insufficientBalance(t.formattedCurrency)},onSubmit:function(){b.request.displayBalanceDeduct=!1,b.request.renewingProject=!0,t.renewProjectEnrollment({projectId:c.projectId}).$promise.then(function(s){b.request.renewingProject=!1,b.request.isPermissionChecksAvailable=!0,s.hasOwnProperty("success")?(s=s.success[0],e.error=1===parseInt(s.error),e.isEvaluationHistoryExists=1===parseInt(s.isEvaluationHistoryExists),e.isInstructor=1===parseInt(s.isInstructor),e.isMentor=1===parseInt(s.isMentor),e.isPaidUser=1===parseInt(s.isPaidUser),e.isProjectVerifiable=1===parseInt(s.isProjectVerifiable),e.isStudent=1===parseInt(s.isStudent),e.projectName=s.projectName,e.projectId=s.projectId,e.enrollmentExpiringOn=l.getLocalMediumDateByTimestamp(null,s.enrollment_expires_on),e.isEnrollmentExpired=!1):u.error(o.getComponentMessages("classroomMessages").getMessage("somethingWentWrong"))},function(e){b.request.renewingProject=!1,e=r.processError(e),u.error(o.getComponentMessages("classroomMessages").getMessage("somethingWentWrong"))})},onCancel:function(){}})}}function h(){t.createUserClassroomVisitLog({projectId:c.projectId})}function I(){return{balanceTemplateDetails:{}}}function j(){return{fetchingClassroomBasicDetails:!1,isPermissionChecksAvailable:!1,renewingProject:!1,displayBalanceDeduct:!1}}function D(){var e=s.get();m.setCurrentRoute({state:"root.classroom",params:{projectId:c.projectId}}),a.go("root.evaluation-history",{projectId:c.projectId,publicName:e.name})}function P(){n.$on(s.events.onSessionUpdate,function(){s.exist()||_()})}function _(){w={},b.request=j(),b.subscriptionDetails=I()}var b,w={};return b={init:g,getClassroomBasicDetails:f,renewEnrollment:y,gotoEvaluationHistory:D,subscriptionDetails:I(),messages:o.getComponentMessages("classroomMessages"),paths:{ajaxLoaderImg:i.getPath("images.content-loader")},request:j()}}return e.$inject=["$q","session","rest","restMiddleware","messageService","pathService","$state","$rootScope","dateService","$stateParams","toastr","storeService","popup","evaluationHistoryService","routerHelperResolver"],e}),define("classroom-overview-controller",[],function(){function e(e){function s(){i.request=e.request,i.messages=e.messages,i.events={},i.errors=e.errors,i.paths=e.paths,i.ajaxLoaderOverviewDetails={msg:i.messages.getMessage("loading"),loaderImg:i.paths.ajaxLoaderImg},e.init(),t(),r()}function t(){e.getOverviewDetails().then(function(e){i.kitDetails=e.projectKitDetails,i.syllabusPath=e.syllabusPath})}function r(){i.events.reloadOverviewDetails=o}function o(){i.errors.overviewDetails=null,t()}var i=this;s()}return e.$inject=["classroomOverviewService"],e}),define("classroom-overview-service",[],function(){function e(e,s,t,r,o,i,a,n,l,c,u,d,p){function m(){y()}function v(){function e(){function e(e){var s={error:!0,msg:""};switch(e.code){default:s.msg=r.getComponentMessages("classroomOverviewMessages").getMessage("fetchingFailed")}return s}function s(e){var s={projectKitDetails:null,syllabusPath:null};return e.hasOwnProperty("courseKitDetails")&&(s.projectKitDetails={kitName:e.courseKitDetails.kitName,kitId:e.courseKitDetails.storeKitId},e.courseKitDetails.hasOwnProperty("kitUrl")||(s.projectKitDetails.kitUrl=l.getKitUrl(e.courseKitDetails.storeKitId)),e.courseKitDetails.hasOwnProperty("kitImage")&&(s.projectKitDetails.kitImageUrl=l.getKitImageUrl(e.courseKitDetails.kitImage))),e.projectSyllabusFile[0].hasOwnProperty("course_syllabus")&&e.projectSyllabusFile[0].course_syllabus&&(s.syllabusPath=c.getFileUrl({folderName:u.getBaseProjectSyllabusS3Container(),filePath:e.projectSyllabusFile[0].folder_name+"/"+e.projectSyllabusFile[0].course_syllabus})),s}var i=n.projectId;if(j.hasOwnProperty(i)){if(j[i].exist())return j[i];j[i].recreatePromise()}else j[i]=a.createPromise();return I.request.fetchingOverviewDetails=!0,t.getClassroomOverviewDetails({projectId:i}).$promise.then(function(e){var t=p.get("lastVisitedLesson"+n.projectId);e.lastLessonVisited.length&&!t&&d.go("root.classroom.lesson-details",{sectionId:e.lastLessonVisited[0].section_id,lessonId:e.lastLessonVisited[0].lesson_id}),I.request.fetchingOverviewDetails=!1,j[i].resolve(s(e))},function(s){I.request.fetchingOverviewDetails=!1,s=o.processError(s),I.errors.overviewDetails=e(s),j[i].reject(),j[i].destroy()}),j[i]}return e()}function g(){return{fetchingOverviewDetails:!1}}function f(){return{overviewDetails:null}}function y(){function t(e,s){h()}e.listenEvent({componentName:"overviewDetails",eventName:s.events.onSessionUpdate,eventCallback:t})}function h(){j={},I.request=g(),I.errors=f()}var I,j={};return I={init:m,getOverviewDetails:v,request:g(),messages:r.getComponentMessages("classroomOverviewMessages"),errors:f(),paths:{ajaxLoaderImg:i.getPath("images.content-loader")}}}return e.$inject=["eventService","session","rest","messageService","restMiddleware","pathService","promiseService","$stateParams","storeService","fileHelperService","projectService","$state","$cookies"],e}),define("project-syllabus-directive",[],function(){function e(e,s,t){function r(r,o,i,a){function n(s){r.processing=!0,e.init(),e.getProjectSyllabus(s).then(function(){var t=e.projectSyllabus[s].data;r.processing=!1,t.length>0&&l(t)},function(){r.processing=!1,r.errorObj={error:!0,msg:c.getMessage("projectSyllabusFetchFailed")}})}function l(e){function s(){for(var s=0;s<e.length;s++)r.syllabus.push({sectionId:parseInt(e[s].section_id,10),lessonId:parseInt(e[s].lesson_id,10),lessonName:e[s].lesson_display_name?e[s].lesson_display_name:e[s].lesson_name,sectionName:e[s].section_display_name?e[s].section_display_name:e[s].section_name});if(i.defaultSelectedLesson)if("all"!==r.defaultSelectedLesson.sectionId){for(var s=0;s<r.syllabus.length;s++)if(parseInt(r.defaultSelectedLesson.sectionId)===r.syllabus[s].sectionId&&parseInt(r.defaultSelectedLesson.lessonId)===r.syllabus[s].lessonId){r.section=r.syllabus[s];break}}else for(var s=0;s<r.syllabus.length;s++)if(parseInt(r.defaultSelectedLesson.lessonId)===r.syllabus[s].lessonId){r.section=r.syllabus[s];break}}function t(){for(var s=[],t=0,o=0;o<e.length;o++)t=s.indexOf(e[o].section_id),t<0?(s.push(e[o].section_id),r.syllabus.push({sectionId:e[o].section_id,sectionName:e[o].section_display_name?e[o].section_display_name:e[o].section_name,lessons:[{id:parseInt(e[o].lesson_id),name:e[o].lesson_display_name?e[o].lesson_display_name:e[o].lesson_name}]})):r.syllabus[t].lessons.push({id:parseInt(e[o].lesson_id),name:e[o].lesson_display_name?e[o].lesson_display_name:e[o].lesson_name})}if(r.syllabus=[],!i.role)return s();switch(i.role.toLowerCase()){case"dropdown":return s();case"accordion":return t();default:return s()}}if(!i.projectId&&!i.syllabusDetails)throw"project-id is missing";if(i.syllabusDetails)r.$watch("syllabusDetails",function(e){e&&l(r.syllabusDetails)});else{var c=t.getComponentMessages("projects");r.ajaxLoaderProjectSyllabusDetails={msg:c.getMessage("LoadingProjectSyllabus"),loaderImg:s.getPath("images.content-loader")},n(r.projectId)}r.selectedLesson=function(e){r.onLessonChange({lessonDetails:e})},r.reloadSyllabus=function(){r.errorObj=null,n(r.projectId)}}function o(e,t){if(!t.role)return s.getPath("project.project-syllabus-dropdown-html");switch(t.role.toLowerCase()){case"dropdown":return s.getPath("project.project-syllabus-dropdown-html");case"accordion":return s.getPath("project.project-syllabus-accordion-html");default:return s.getPath("project.project-syllabus-dropdown-html")}}return{restrict:"E",templateUrl:o,scope:{projectId:"=",onLessonChange:"&",showLessonLink:"@",defaultSelectedLesson:"=",syllabusDetails:"=",role:"@"},link:r}}return e.$inject=["projectService","pathService","messageService"],e}),define("evaluation-history-service",[],function(){function e(e,s,t,r,o,i,a,n,l,c){function u(){y()}function d(){function e(){if(I.evaluationHistory.hasOwnProperty(d)){if(I.evaluationHistory[d].historyPromise){if(I.evaluationHistory[d].historyPromise.exist())return I.evaluationHistory[d].historyPromise;I.evaluationHistory[d].historyPromise.recreatePromise()}}else I.evaluationHistory[d]={},I.evaluationHistory[d].historyPromise=l.createPromise();return r()}function r(){return I.request.fetchingEvaluationHistory=!0,I.status.evaluationHistoryNotExists=!1,s.getEvaluationHistory({projectId:d,publicName:o.publicName}).$promise.then(function(e){I.request.fetchingEvaluationHistory=!1,i(e),I.evaluationHistory[d].historyPromise.resolve(d)},function(e){I.request.fetchingEvaluationHistory=!1;var s=t.processError(e);I.evaluationHistory[d]&&(I.evaluationHistory[d].historyPromise.reject(u(s)),I.evaluationHistory[d].historyPromise.destroy())}),I.evaluationHistory[d].historyPromise}function i(e){e.hasOwnProperty("notFoundError")&&1===parseInt(e.notFoundError)&&(I.status.evaluationHistoryNotExists=!0),e.hasOwnProperty("permissionError")&&1===parseInt(e.permissionError)&&(I.evaluationHistory[d].historyPromise.destroy(),c.redirectOnPermissionDenied()),e.hasOwnProperty("evaluationHistory")&&(I.evaluationHistory[d].data=a(e.evaluationHistory))}function a(e){for(var s=[],t=0;t<e.length;t++)s.push({id:e[t].id,comment:e[t].comment?e[t].comment:"-",requestedAt:n.getLocalMediumDateByTimestamp(null,e[t].requested_date),is_plagiarized:1===parseInt(e[t].is_plagiarized),score:e[t].total_score_percent+" %",publicName:o.publicName,is_completed:1!==parseInt(e[t].is_pending)});return s}function u(e){var s={error:!0,msg:""};switch(e.code){default:s.msg=I.messages.getMessage("EvaluationHistoryFetchingFailed")}return s}var d=o.projectId;return e()}function p(){function e(){if(I.evaluationHistoryDetails.hasOwnProperty(u)){if(I.evaluationHistoryDetails[u].detailsPromise){if(I.evaluationHistoryDetails[u].detailsPromise.exist())return I.evaluationHistoryDetails[u].detailsPromise;I.evaluationHistoryDetails[u].detailsPromise.recreatePromise()}}else I.evaluationHistoryDetails[u]={},I.evaluationHistoryDetails[u].detailsPromise=l.createPromise();return r()}function r(){return I.request.fetchingEvaluationHistoryDetails=!0,s.getEvaluationHistoryDetails({verificationRequestId:u,projectId:o.projectId,publicName:o.publicName}).$promise.then(function(e){I.request.fetchingEvaluationHistoryDetails=!1,i(e),I.evaluationHistoryDetails[u].detailsPromise.resolve(u)},function(e){I.request.fetchingEvaluationHistoryDetails=!1;var s=t.processError(e);I.evaluationHistoryDetails[u]&&(I.evaluationHistoryDetails[u].detailsPromise.reject(n(s)),I.evaluationHistoryDetails[u].detailsPromise.destroy())}),I.evaluationHistoryDetails[u].detailsPromise}function i(e){e.hasOwnProperty("notFoundError")&&1===parseInt(e.notFoundError)&&(I.status.historyDetailsNotExists=!0),e.hasOwnProperty("permissionError")&&1===parseInt(e.permissionError)&&(I.evaluationHistoryDetails[u].detailsPromise.destroy(),c.redirectOnPermissionDenied()),e.hasOwnProperty("scoreDetails")&&(0===e.scoreDetails.length&&(I.evaluationHistoryDetails[u].detailsPromise.destroy(),c.redirectOnPermissionDenied()),I.evaluationHistoryDetails[u].data=a(e.scoreDetails,e.checklist))}function a(e,s){for(var t=[],r=0,o={},i=[],a=0,n=0;n<e.length;n++)i.push({description:e[n].description,taskScore:e[n].task_score,taskScorePercentage:e[n].task_score_percentage+" %",weightage:e[n].weightage+" %"}),a+=parseFloat(e[n].task_score_percentage);a=a.toFixed(2)+" %";for(var l={taskScore:i,checklistScore:[],isPlagiarized:1===parseInt(e[0].is_plagiarized),totalScore:a},c=e[0].project_tasks.split(","),n=0;n<s.length;n++){r=t.indexOf(s[n].section_id),o={id:s[n].checklist_id,name:s[n].checklist_name,description:s[n].checklist_description,weightage:s[n].checklist_weightage,checklist_passed:!1};for(var u=0;u<c.length;u++)if(parseInt(c[u])===parseInt(s[n].checklist_id)){o.checklist_passed=!0;break}r<0?(t.push(s[n].section_id),l.checklistScore.push({section_id:s[n].section_id,section_name:s[n].section_name,section_weightage:parseInt(s[n].checklist_weightage),checklist_details:[o]})):(l.checklistScore[r].section_weightage+=parseInt(s[n].checklist_weightage),l.checklistScore[r].checklist_details.push(o))}return l}function n(e){var s={error:!0,msg:""};switch(e.code){default:s.msg=I.messages.getMessage("EvaluationHistoryFetchingFailed")}return s}var u=o.verificationRequestId;return e()}function m(){return{fetchingEvaluationHistory:!1,fetchingEvaluationHistoryDetails:!1}}function v(){return{evaluationHistoryNotExists:!1,historyDetailsNotExists:!1}}function g(e){j=e}function f(){switch(j.state){case"root.classroom":i.go("root.classroom",{projectId:j.params.projectId});break;case"root.dashboard.account.profile":i.go("root.dashboard.account.profile");break;case"root.dashboard.learning.project-evaluations":i.go("root.dashboard.learning.project-evaluations");break;case"root.dashboard.account.privacy-settings":i.go("root.dashboard.account.privacy-settings")}}function y(){a.$on(e.events.onSessionUpdate,function(){e.exist()||h()})}function h(){I.request=m(),I.status=v(),I.evaluationHistory={},I.evaluationHistoryDetails={}}var I,j={state:"root.dashboard.account.profile"};return I={init:u,getEvaluationHistory:d,evaluationHistory:{},evaluationHistoryDetails:{},setCurrentRoute:g,getEvaluationHistoryDetails:p,messages:r.getComponentMessages("evaluationHistoryMessages"),request:m(),status:v(),onBack:f}}return e.$inject=["session","rest","restMiddleware","messageService","$stateParams","$state","$rootScope","dateService","promiseService","routerHelperResolver"],e}),define("app/classroom/classroom.runtime.js",["classroom-controller","classroom-service","classroom-overview-controller","classroom-overview-service","project-syllabus-directive","evaluation-history-service"],function(e,s,t,r,o,i){return{ClassroomController:e,classroomService:s,ClassroomOverviewController:t,classroomOverviewService:r,projectSyllabusDirective:o,evaluationHistoryService:i}});